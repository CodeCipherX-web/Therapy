// Simple script to load .env and generate config.env.js for browser
const fs = require('fs');
const path = require('path');

const envPath = path.join(__dirname, '.env');
let envVars = {};

if (fs.existsSync(envPath)) {
  const envContent = fs.readFileSync(envPath, 'utf8');
  const lines = envContent.split('\n');
  
  lines.forEach(line => {
    line = line.trim();
    if (line && !line.startsWith('#')) {
      const [key, ...valueParts] = line.split('=');
      if (key && valueParts.length > 0) {
        const value = valueParts.join('=').trim().replace(/^["']|["']$/g, '');
        envVars[key.trim()] = value;
      }
    }
  });
}

const configContent = `// Auto-generated from .env file
// DO NOT EDIT - Generated by load-env.js
// NOTE: OPENROUTER_API_KEY is NOT included here for security (handled server-side)

if (typeof window !== 'undefined') {
  window.ENV_CONFIG = {
    SUPABASE_URL: '${envVars.SUPABASE_URL || ''}',
    SUPABASE_ANON_KEY: '${envVars.SUPABASE_ANON_KEY || ''}',
    // OPENROUTER_API_KEY is intentionally excluded - handled by backend server
    OPENROUTER_MODEL: '${envVars.OPENROUTER_MODEL || 'tngtech/deepseek-r1t2-chimera:free'}',
    SITE_URL: '${envVars.SITE_URL || 'https://tranquilmind.app'}',
    BACKEND_CHAT_URL: '${envVars.BACKEND_CHAT_URL || 'http://localhost:3001'}'
  };
}
`;

fs.writeFileSync(path.join(__dirname, 'config.env.js'), configContent);
console.log('âœ… Generated config.env.js from .env file');

